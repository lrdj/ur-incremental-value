{% extends "layouts/main.html" %}
{% block pageTitle %}Insight{% endblock %}

{% block content %}

      <div class="govuk-grid-row">
        <div class="govuk-grid-column-three-quarters">

<span class="govuk-caption-m">Logged UR insight</span>
<h1 class="govuk-heading-l">{{ insight.title }}</h1>
<p class="govuk-body-l">{{ insight.description }}</p>
<p class="govuk-body"><strong>What we observed:</strong><br>{{ insight.what_we_observed }}</p>
<p class="govuk-body"><strong>Why it matters:</strong><br>{{ insight.why_it_matters }}</p>
<p class="govuk-body">
  <strong>Evidence:</strong>
  {% if insight.evidence and ';' in insight.evidence %}
    <ul class="govuk-list govuk-list--bullet">
    {% for item in insight.evidence.split(';') %}
      <li>{{ item | trim }}</li>
    {% endfor %}
    </ul>
  {% else %}
    {{ insight.evidence }}
  {% endif %}
</p>
<p class="govuk-body">
  <strong>Source:</strong> {{ insight.source }} · <strong>Discovered:</strong> {{ insight.date_discovered }}
  {% if insight.contains_pii %}<span class="govuk-tag govuk-tag--red govuk-!-margin-left-2">PII</span>{% endif %}
</p>

<h2 class="govuk-heading-m">Influences objectives</h2>
<ul class="govuk-list govuk-list--bullet">
  {% for o in objs %}
    <li>{{ o.title }} <span class="govuk-hint">({{ o.link_type }})</span></li>
  {% endfor %}
</ul>

<h2 class="govuk-heading-m">Contributes to key results</h2>
<table class="govuk-table">
  <thead><tr class="govuk-table__row">
    <th class="govuk-table__header">Key result</th>
    <th class="govuk-table__header">Weight</th>
    <th class="govuk-table__header">Confidence</th>
    <th class="govuk-table__header">Mechanism</th>
  </tr></thead>
  <tbody>
  {% for kr in krs %}
    <tr class="govuk-table__row">
      <td class="govuk-table__cell"><a href="/okr/kr/{{ kr.id }}">{{ kr.title }}</a></td>
      <td class="govuk-table__cell">{{ kr.contribution_weight }}</td>
      <td class="govuk-table__cell">{{ kr.confidence }}</td>
      <td class="govuk-table__cell">{{ kr.mechanism }}</td>
    </tr>
  {% endfor %}
  </tbody>
</table>

<h2 class="govuk-heading-m">Decisions informed</h2>
<ul class="govuk-list govuk-list--bullet">
  {% for d in decisions %}
    <li>{{ d.decided_on }} – {{ d.summary }} <span class="govuk-hint">({{ d.project_name }})</span></li>
  {% endfor %}
</ul>

<h2 class="govuk-heading-m">Experiments linked</h2>
<ul class="govuk-list govuk-list--bullet">
  {% for e in experiments %}
    <li>{{ e.project_name }}: {{ e.hypothesis }} – <strong>{{ e.status }}</strong> {% if e.result %} ({{ e.result }}){% endif %}</li>
  {% endfor %}
</ul>

<p class="govuk-body"><a class="govuk-link" href="/insights">Back to insights</a></p>

        </div>
        <div class="govuk-grid-column-one-quarter">
          <p class="govuk-body">
          <!-- right-hand column goes here...
          </p>
        </div>
      </div>


{% endblock %}
